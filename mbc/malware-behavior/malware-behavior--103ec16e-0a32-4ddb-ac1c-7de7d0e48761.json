{
    "type": "bundle",
    "id": "bundle--db7aba48-5bbc-4551-beaf-92f6732bb954",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2019-08-01T00:00:00.000Z",
            "modified": "2023-12-05T00:00:00.000Z",
            "name": "Process Injection",
            "obj_defn": {
                "description": "Malware may execute code in the address space of a separate process. \n\nSee ATT&CK: **Process Injection ([T1055](https://attack.mitre.org/techniques/T1055/), [T1631](https://attack.mitre.org/techniques/T1631/))**.\n\nThe methods table includes existing ATT&CK sub-techniques, which have been enhanced with malware-specific details, as well as new methods. Note that IAT hooking and inline hooking (aka userland rootkits) are defined as methods under the [Hijack Execution Flow](https://github.com/MBCProject/mbc-markdown/blob/main/defense-evasion/hijack-execution-flow.md) behavior.",
                "external_id": "E1055",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/defense-evasion/process-injection.md"
            },
            "objective_refs": [
                "malware-objective--7338da7e-620b-4cb0-8896-6b3c058a1d1c",
                "malware-objective--aca2c869-58c8-47e5-9ae1-cebd7f18fbcd"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "VirtualProtect",
                        "GetProcAddress",
                        "ReadProcessMemory"
                    ],
                    "detect_ref": "malware-method--1822b2c0-2083-4f9d-b264-4d3feda77508",
                    "rule_name": "patch process command line",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-forensic/patch-process-command-line.yml"
                },
                {
                    "api_fncs": [
                        "ntoskrnl.KeStackAttachProcess",
                        "ntoskrnl.KeUnstackDetachProcess"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_name": "attach user process memory",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/inject/attach-user-process-memory.yml"
                },
                {
                    "api_fncs": [
                        "SetWindowLong",
                        "SetWindowLongPtr",
                        "PostMessage",
                        "SendNotifyMessage"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_name": "inject shellcode using extra window memory",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/inject/inject-shellcode-using-extra-window-memory.yml"
                },
                {
                    "api_fncs": [
                        "CreateFileMapping",
                        "MapViewOfFile",
                        "MapViewOfFileNuma2"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_name": "inject shellcode using a file mapping object",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/inject/inject-shellcode-using-a-file-mapping-object.yml"
                },
                {
                    "api_fncs": [
                        "user32.SetProp",
                        "PostMessage",
                        "SendNotifyMessage"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_name": "inject shellcode using window subclass procedure",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/inject/inject-shellcode-using-window-subclass-procedure.yml"
                },
                {
                    "api_fncs": [
                        "ConvertThreadToFiber",
                        "CreateFiber",
                        "SwitchToFiber"
                    ],
                    "detect_ref": "malware-method--66aa447c-bc49-4116-af9c-3cc314850e01",
                    "rule_name": "execute shellcode via Windows fibers",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/load-code/shellcode/execute-shellcode-via-windows-fibers.yml"
                },
                {
                    "rule_name": "volatility_handles_1",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/volatility_handles_1.py"
                },
                {
                    "rule_name": "volatility_ldrmodules_1",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/volatility_ldrmodules_1.py"
                },
                {
                    "rule_name": "volatility_ldrmodules_2",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/volatility_ldrmodules_2.py"
                },
                {
                    "rule_name": "volatility_malfind_1",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/volatility_malfind_1.py"
                },
                {
                    "rule_name": "volatility_malfind_2",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/volatility_malfind_2.py"
                },
                {
                    "rule_name": "volatility_modscan_1",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/volatility_modscan_1.py"
                },
                {
                    "api_fncs": [
                        "NtReadVirtualMemory",
                        "NtWow64ReadVirtualMemory64",
                        "NtOpenProcess",
                        "FindWindowExA",
                        "SendNotifyMessageW",
                        "SendNotifyMessageA",
                        "NtCreateSection",
                        "SetWindowLongA",
                        "SetWindowLongW",
                        "FindWindowA",
                        "FindWindowW",
                        "FindWindowExW",
                        "ReadProcessMemory",
                        "SetWindowLongPtrA",
                        "NtOpenSection",
                        "SetWindowLongPtrW"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "rule_name": "injection_explorer",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/injection_explorer.py"
                },
                {
                    "api_fncs": [
                        "ThemeInitApiHook"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "rule_name": "injection_themeinitapihook",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/injection_themeinitapihook.py"
                },
                {
                    "api_fncs": [
                        "WinHttpConnect",
                        "WinHttpOpenRequest"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "rule_name": "explorer_http",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/explorer_http.py"
                },
                {
                    "rule_name": "injection_createremotethread",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/injection_createremotethread.py"
                },
                {
                    "rule_name": "doppelganging",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/kevoreilly/CAPEv2/blob/master/modules/signatures/CAPE.py"
                },
                {
                    "rule_name": "injection_inter_process",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/kevoreilly/CAPEv2/blob/master/modules/signatures/CAPE.py"
                },
                {
                    "rule_name": "injection_create_remote_thread",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/kevoreilly/CAPEv2/blob/master/modules/signatures/CAPE.py"
                },
                {
                    "rule_name": "injection_process_hollowing",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/kevoreilly/CAPEv2/blob/master/modules/signatures/CAPE.py"
                },
                {
                    "api_fncs": [
                        "NtMapViewOfSection",
                        "SetWindowLongW",
                        "FindWindowExA",
                        "SendNotifyMessageW",
                        "SendNotifyMessageA",
                        "NtCreateSection",
                        "SetWindowLongA",
                        "FindWindowA",
                        "PostMessageA",
                        "FindWindowW",
                        "FindWindowExW",
                        "PostMessageW",
                        "SetWindowLongPtrA",
                        "NtOpenSection",
                        "SetWindowLongPtrW"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "rule_name": "injection_set_window_long",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/injection_set_window_long.py"
                },
                {
                    "api_fncs": [
                        "NtRollbackTransaction",
                        "NtMapViewOfSection",
                        "RtlSetCurrentTransaction"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "rule_name": "transacted_hollowing",
                    "url": "https://github.com/kevoreilly/CAPEv2/blob/master/modules/signatures/CAPE.py"
                },
                {
                    "rule_name": "persistence_ifeo",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/persistence_ifeo.py"
                },
                {
                    "detect_ref": "malware-method--ee66b9c0-3877-4446-bc47-b71876ec156f",
                    "rule_name": "persistence_ifeo",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/persistence_ifeo.py"
                },
                {
                    "rule_name": "persistence_slient_process_exit",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/persistence_slient_process_exit.py"
                },
                {
                    "api_fncs": [
                        "VirtualProtectEx",
                        "NtAllocateVirtualMemory",
                        "NtProtectVirtualMemory"
                    ],
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "rule_name": "injection_rwx",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/injection_rwx.py"
                },
                {
                    "detect_ref": "malware-method--3c925108-3368-43b3-8d80-4b6456e57abb",
                    "rule_name": "persistence_shim_database",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/persistence_shim_database.py"
                },
                {
                    "rule_name": "injection_runpe",
                    "detect_ref": "malware-behavior--103ec16e-0a32-4ddb-ac1c-7de7d0e48761",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/injection_runpe.py"
                }
            ],
            "obj_version": "2.1",
            "related_object_refs": [
                "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d",
                "attack-pattern--b7c0e45f-0206-4f75-96e7-fe7edad3aaff"
            ],
            "external_references": [
                {
                    "source_name": "hosseini",
                    "description": "A. Hosseini, \"Ten Process Injection Techniques: A Technical Survey of Common and Trending Process Injection Techniques,\" Elastic, blog, Jul. 18, 2017 [Online].",
                    "url": "https://www.elastic.co/blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
                },
                {
                    "source_name": "fireeye-poisonivy",
                    "description": "\"Poison Ivy: Assessing Damange and Extracting Intelligence,\" FireEye, Special Report, 2014 [Online].",
                    "url": "https://www.mandiant.com/sites/default/files/2021-09/rpt-poison-ivy.pdf"
                },
                {
                    "source_name": "lordnoteworthy",
                    "description": "A. Faouzi (LordNoteworthy), \"README.md,\" Al-Khaser v0.81. Accessed Apr. 29, 2023 [Online].",
                    "url": "https://github.com/LordNoteworthy/al-khaser"
                },
                {
                    "source_name": "citizen lab",
                    "description": "M. Brooks, J. Dalek, and M. Crete-Nishihata, \"Between Hong Kong and Burma: Tracking UP007 and SLServer Espionage Campaigns,\" The Citizen Lab, Apr. 18, 2016 [Online].",
                    "url": "https://docs.microsoft.com/en-us/windows/win32/winmsg/about-hooks?redirectedfrom=MSDN#hook-procedures"
                },
                {
                    "source_name": "readteamnotes",
                    "description": "Red Team Notes, \"Shellcode Execution through Fibers\" [Online].",
                    "url": "https://www.ired.team/offensive-security/code-injection-process-injection/executing-shellcode-with-createfiber"
                },
                {
                    "source_name": "sophos-cryptowall",
                    "description": "\"The current state of ransomware: CryptoWall,\" Sophos News, Dec. 17, 2015 [Online].",
                    "url": "https://news.sophos.com/en-us/2015/12/17/the-current-state-of-ransomware-cryptowall/"
                },
                {
                    "source_name": "fsecure-hupigon",
                    "description": "\"Backdoor:W32/Hupigon,\" F-Secure, Threat Description [Online].",
                    "url": "https://www.f-secure.com/v-descs/backdoor_w32_hupigon.shtml"
                },
                {
                    "source_name": "fsecure-quedagh",
                    "description": "\"BlackEnergy & Quedagh: The convergence of crimeware and APT attacks,\" F-Secure Labs [Online].",
                    "url": "https://blog-assets.f-secure.com/wp-content/uploads/2019/10/15163408/BlackEnergy_Quedagh.pdf"
                },
                {
                    "source_name": "falliere-stuxnet",
                    "description": "N. Falliere, L. Murchu, and E. Chien, \"W32.Stuxnet Dossier,\" Symantec Security Response, Feb. 2011 [Online].",
                    "url": "https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en"
                },
                {
                    "source_name": "victor-netwalker",
                    "description": "K. Victor, \"Reflective Loading Runs Netwalker Fileless Ransomware,\" Trend Micro, May 18, 2020 [Online].",
                    "url": "https://www.trendmicro.com/en_us/research/20/e/netwalker-fileless-ransomware-injected-via-reflective-loading.html"
                },
                {
                    "source_name": "cybereason-trickbot",
                    "description": "Cybereason Nocturnus, \"Dropping Anchor: From a TrickBot Infection to the Discovery of the Anchor Malware,\" Cybereason, blog, Dec. 11, 2019 [Online].",
                    "url": "https://www.cybereason.com/blog/research/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware"
                },
                {
                    "source_name": "mcafee-webcobra",
                    "description": "\"WebCobra Malware Uses Victims' Computers to Mine Cryptocurrency,\" McAfee, blog, Nov. 12, 2018 [Online].",
                    "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/webcobra-malware-uses-victims-computers-to-mine-cryptocurrency/"
                },
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}