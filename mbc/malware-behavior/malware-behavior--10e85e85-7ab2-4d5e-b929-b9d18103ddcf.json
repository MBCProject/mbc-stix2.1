{
    "type": "bundle",
    "id": "bundle--a12ac842-0afa-47f9-a8c2-4023774e8faf",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--10e85e85-7ab2-4d5e-b929-b9d18103ddcf",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2022-08-02T00:00:00.000Z",
            "modified": "2024-04-30T00:00:00.000Z",
            "name": "File and Directory Discovery",
            "obj_defn": {
                "source_name": "mitre-mbc",
                "description": "Malware may enumerate files and directories or may search for specific files or in specific locations.",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/discovery/file-and-directory-discovery.md",
                "external_id": "E1083"
            },
            "objective_refs": [
                "malware-objective--18596919-b718-4067-a5c9-5aea8b9dd001"
            ],
            "detection_rules": [
                {
                    "rule_type": "capa",
                    "rule_name": "get common file path",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/file-system/get-common-file-path.yml",
                    "api_fncs": [
                        "kernel32.GetTempPath",
                        "kernel32.GetTempFileName",
                        "kernel32.GetSystemDirectory",
                        "kernel32.GetWindowsDirectory",
                        "kernel32.GetSystemWow64Directory",
                        "GetAllUsersProfileDirectory",
                        "GetAppContainerFolderPath",
                        "GetCurrentDirectory",
                        "GetDefaultUserProfileDirectory",
                        "GetProfilesDirectory",
                        "GetUserProfileDirectory",
                        "SHGetFolderPathAndSubDir",
                        "shell32.SHGetFolderPath",
                        "shell32.SHGetFolderLocation",
                        "shell32.SHGetKnownFolderPath",
                        "shell32.SHGetSpecialFolderPath",
                        "shell32.SHGetSpecialFolderLocation",
                        "System.IO.Directory::GetCurrentDirectory",
                        "System.Environment::GetFolderPath"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "get file version info",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/file-system/meta/get-file-version-info.yml",
                    "api_fncs": [
                        "version.GetFileVersionInfo",
                        "version.GetFileVersionInfoEx",
                        "System.Diagnostics.FileVersionInfo::GetVersionInfo",
                        "version.VerQueryValue",
                        "version.GetFileVersionInfoSize",
                        "version.GetFileVersionInfoSizeEx"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "get file size",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/file-system/meta/get-file-size.yml",
                    "api_fncs": [
                        "kernel32.GetFileSize",
                        "kernel32.GetFileSizeEx"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "check if file exists",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/file-system/exists/check-if-file-exists.yml",
                    "api_fncs": [
                        "kernel32.GetFileAttributes",
                        "kernel32.GetLastError",
                        "shlwapi.PathFileExists",
                        "System.IO.File::Exists"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "enumerate files on Linux",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/file-system/files/list/enumerate-files-on-linux.yml",
                    "api_fncs": [
                        "getdents",
                        "getdents64",
                        "opendir",
                        "readdir"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "enumerate files on Windows",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/file-system/files/list/enumerate-files-on-windows.yml",
                    "api_fncs": [
                        "kernel32.FindFirstFile",
                        "kernel32.FindFirstFileEx",
                        "kernel32.FindFirstFileTransacted",
                        "kernel32.FindFirstFileName",
                        "kernel32.FindFirstFileNameTransacted",
                        "kernel32.FindNextFile",
                        "kernel32.FindNextFileName",
                        "kernel32.FindClose",
                        "ntdll.NtOpenDirectoryObject",
                        "ntdll.NtQueryDirectoryObject",
                        "RtlAllocateHeap",
                        "System.IO.DirectoryInfo::GetFiles",
                        "System.IO.DirectoryInfo::EnumerateFiles",
                        "System.IO.Directory::GetFiles",
                        "System.IO.Directory::EnumerateFiles",
                        "System.IO.Directory::EnumerateFileSystemEntries",
                        "System.IO.DirectoryInfo::GetDirectories",
                        "System.IO.DirectoryInfo::EnumerateDirectories",
                        "System.IO.Directory::GetDirectories",
                        "System.IO.Directory::EnumerateDirectories"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "enumerate files recursively",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/file-system/files/list/enumerate-files-recursively.yml"
                },
                {
                    "rule_type": "capa",
                    "rule_name": "read data from CLFS log container",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/log/clfs/read-data-from-clfs-log-container.yml",
                    "api_fncs": [
                        "clfsw32.CreateLogFile",
                        "clfsw32.CreateLogMarshallingArea",
                        "clfsw32.ReadLogRecord",
                        "clfsw32.ReadNextLogRecord"
                    ],
                    "detect_ref": "malware-method--8c891ada-147e-4d06-bd09-c8fcb3e42066"
                },
                {
                    "rule_type": "capa",
                    "rule_name": "access the Windows event log",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/log/winevt/access/access-the-windows-event-log.yml",
                    "api_fncs": [
                        "OpenEventLog",
                        "ClearEventLog",
                        "OpenBackupEventLog",
                        "ReportEvent"
                    ],
                    "detect_ref": "malware-method--8c891ada-147e-4d06-bd09-c8fcb3e42066"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antisandbox_cuckoo_files",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antisandbox_cuckoo_files.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antisandbox_threattrack_files",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antisandbox_threattrack_files.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_directory_objects",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_dirobjects.py",
                    "api_fncs": [
                        "NtQueryDirectoryObject",
                        "NtOpenDirectoryObject"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vmware_events",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vmware_events.py",
                    "api_fncs": [
                        "NtOpenEvent",
                        "NtCreateEvent"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vmware_events",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vmware_events.py",
                    "api_fncs": [
                        "NtOpenEvent",
                        "NtCreateEvent"
                    ],
                    "detect_ref": "malware-method--8c891ada-147e-4d06-bd09-c8fcb3e42066"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vbox_devices",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vbox_devices.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vmware_devices",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vmware_devices.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vbox_files",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vbox_files.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vmware_libs",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vmware_libs.py",
                    "api_fncs": [
                        "LdrLoadDll"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antiav_detectfile",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antiav_detectfile.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vpc_files",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vpc_files.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vbox_libs",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vbox_libs.py",
                    "api_fncs": [
                        "LdrLoadDll"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "driver_filtermanager",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/driver_filtermanager.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antisandbox_joe_anubis_files",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antisandbox_joe_anubis_files.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_vmware_files",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_vmware_files.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antisandbox_fortinet_files",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antisandbox_fortinet_files.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antisandbox_sunbelt_files",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antisandbox_sunbelt_files.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antianalysis_detectfile",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antianalysis_detectfile.py"
                }
            ],
            "obj_version": "2.3",
            "related_object_refs": [
                "attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18"
            ],
            "external_references": [
                {
                    "source_name": "sophos-cryptowall",
                    "description": "\"The current state of ransomware: CryptoWall,\" Sophos News, Dec. 17, 2015 [Online].",
                    "url": "https://news.sophos.com/en-us/2015/12/17/the-current-state-of-ransomware-cryptowall/"
                },
                {
                    "source_name": "jarvis",
                    "description": "K. Jarvis, \"CryptoLocker Ransomware,\" Secureworks, Dec. 18, 2013 [Online].",
                    "url": "https://www.secureworks.com/research/cryptolocker-ransomware"
                },
                {
                    "source_name": "s2grupo",
                    "description": "\"Evolution of Trickbot,\" S2 Grupo, report, Jun. 2017 [Online].",
                    "url": "https://www.securityartwork.es/wp-content/uploads/2017/07/Trickbot-report-S2-Grupo.pdf"
                },
                {
                    "source_name": "dong-matanbuchus",
                    "description": "C. Dong, \"MATANBUCHUS: Another Loader as a Service Malware,\" Offset Training Solutions, blog, Feb. 15, 2022 [Online].",
                    "url": "https://www.0ffset.net/reverse-engineering/matanbuchus-loader-analysis/"
                },
                {
                    "source_name": "cohen-matabuchus",
                    "description": "B. Cohen, \"Inside Matanbuchus: A Quirky Loader,\" CyberArk, blog, Jul. 26, 2022 [Online].",
                    "url": "https://www.cyberark.com/resources/threat-research-blog/inside-matanbuchus-a-quirky-loader"
                },
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                },
                {
                    "source_name": "mechtinger",
                    "description": "A. Mechtinger, \"Operation ElectroRAT: Attacker Creates Fake Companies to Drain Your Crypto Wallets,\" Intezer, blog, Jan. 5, 2021 [Online].",
                    "url": "https://www.intezer.com/blog/research/operation-electrorat-attacker-creates-fake-companies-to-drain-your-crypto-wallets/"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}