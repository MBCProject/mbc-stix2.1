{
    "type": "bundle",
    "id": "bundle--525d1173-311b-492e-83b2-ef79f0128d6e",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--44684ff1-9409-4340-9c8a-3c626aca64a9",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2022-08-02T00:00:00.000Z",
            "modified": "2024-04-30T00:00:00.000Z",
            "name": "System Information Discovery",
            "obj_defn": {
                "source_name": "mitre-mbc",
                "description": "Malware may attempt to get detailed information about the system. This can include details about the operating system, hardware configurations, installed software, system uptime, and other system-level details.\n\nSee ATT&CK: **System Information Discovery ([T1082](https://attack.mitre.org/techniques/T1082/))**.",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/discovery/system-information-discovery.md",
                "external_id": "E1082"
            },
            "objective_refs": [
                "malware-objective--18596919-b718-4067-a5c9-5aea8b9dd001"
            ],
            "detection_rules": [
                {
                    "rule_type": "capa",
                    "rule_name": "query environment variable",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/environment-variable/query-environment-variable.yml",
                    "api_fncs": [
                        "kernel32.GetEnvironmentVariable",
                        "kernel32.GetEnvironmentStrings",
                        "kernel32.ExpandEnvironmentStrings",
                        "msvcr90.getenv",
                        "msvcrt.getenv",
                        "System.Environment::GetEnvironmentVariable",
                        "System.Environment::GetEnvironmentVariables",
                        "System.Environment::ExpandEnvironmentVariables"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "get disk information",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/hardware/storage/get-disk-information.yml",
                    "api_fncs": [
                        "kernel32.GetDriveType",
                        "kernel32.GetLogicalDrives",
                        "kernel32.GetVolumeInformation",
                        "kernel32.GetVolumeNameForVolumeMountPoint",
                        "kernel32.GetVolumePathNamesForVolumeName",
                        "kernel32.GetLogicalDriveStrings",
                        "kernel32.QueryDosDevice"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "get disk size",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/hardware/storage/get-disk-size.yml",
                    "api_fncs": [
                        "kernel32.GetDiskFreeSpace",
                        "kernel32.GetDiskFreeSpaceEx"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "check OS version",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/os/version/check-os-version.yml"
                },
                {
                    "rule_type": "capa",
                    "rule_name": "get hostname",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/os/hostname/get-hostname.yml",
                    "api_fncs": [
                        "kernel32.GetComputerName",
                        "kernel32.GetComputerNameEx",
                        "GetComputerObjectName",
                        "ws2_32.gethostname",
                        "gethostname"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_generic_disk",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_generic_disk.py",
                    "api_fncs": [
                        "DeviceIoControl",
                        "NtClose",
                        "NtCreateFile",
                        "NtDuplicateObject",
                        "NtOpenFile",
                        "NtDeviceIoControlFile"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "recon_systeminfo",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/recon_systeminfo.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "recon_beacon",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/recon_beacon.py",
                    "api_fncs": [
                        "HttpOpenRequestA",
                        "HttpSendRequestA"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "uses_adfind",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/uses_adfind.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_generic_cpu",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_generic_cpu.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "accesses_mailslot",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/accesses_netlogon.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "accesses_netlogon_regkey",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/accesses_netlogon.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_generic_bios",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_generic_bios.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_hyperv_keys",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_hyperv_keys.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "uses_windows_utilities_nltest",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/windows_utilities.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_generic_scsi",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_generic_scsi.py",
                    "api_fncs": [
                        "RegOpenKeyExW",
                        "RegQueryValueExA",
                        "RegQueryValueExW",
                        "RegOpenKeyExA"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_parallels_keys",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_parallels_keys.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_generic_diskreg",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_generic_diskreg.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_generic_system",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_generic_system.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "system_account_discovery_cmd",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "system_currently_loggedin_user_cmd",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "system_info_discovery_cmd",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "system_info_discovery_pwsh",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "system_network_discovery_cmd",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "system_network_discovery_pwsh",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "system_user_discovery_cmd",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_generic_services",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_generic_services.py",
                    "api_fncs": [
                        "RegOpenKeyExW",
                        "RegEnumKeyExW",
                        "RegEnumKeyExA",
                        "RegOpenKeyExA"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antivm_generic_disk_setupapi",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antivm_generic_disk_setupapi.py",
                    "api_fncs": [
                        "SetupDiGetClassDevsA",
                        "SetupDiGetClassDevsW"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antisandbox_check_userdomain",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antisandbox_check_userdomain.py",
                    "api_fncs": [
                        "rtcEnvironBstr"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "browser_scanbox",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/browser_scanbox.py",
                    "api_fncs": [
                        "JsEval",
                        "COleScript_ParseScriptText",
                        "COleScript_Compile"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "recon_fingerprint",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/recon_fingerprint.py"
                }
            ],
            "obj_version": "2.3",
            "related_object_refs": [
                "attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1"
            ],
            "external_references": [
                {
                    "source_name": "trendmicro-ursnif",
                    "description": "\"PE_URSNIF.A2,\" Trend Micro, analysis report, Dec. 11, 2014 [Online].",
                    "url": "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/PE_URSNIF.A2"
                },
                {
                    "source_name": "fsecure-quedagh",
                    "description": "\"BlackEnergy & Quedagh: The convergence of crimeware and APT attacks,\" F-Secure Labs [Online].",
                    "url": "https://blog-assets.f-secure.com/wp-content/uploads/2019/10/15163408/BlackEnergy_Quedagh.pdf"
                },
                {
                    "source_name": "kujawa",
                    "description": "A. Kujawa, \"You dirty RAT! Part 1: DarkComet,\" Malwarebytes Labs, blog, Jun. 9, 2012 [Online].",
                    "url": "https://blog.malwarebytes.com/threat-analysis/2012/06/you-dirty-rat-part-1-darkcomet/"
                },
                {
                    "source_name": "trendmicro-emotet",
                    "description": "\"Exploring Emotet's Activities,\" Trend Micro Research, 2019 [Online].",
                    "url": "https://documents.trendmicro.com/assets/white_papers/ExploringEmotetsActivities_Final.pdf"
                },
                {
                    "source_name": "falliere-stuxnet",
                    "description": "N. Falliere, L. Murchu, and E. Chien, \"W32.Stuxnet Dossier,\" Symantec Security Response, Feb. 2011 [Online].",
                    "url": "https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en"
                },
                {
                    "source_name": "fireeye-apt28",
                    "description": "\"APT28: A Window into Russia's Cyber Espionage Operations?\" FireEye, 2014 [Online].",
                    "url": "https://www2.fireeye.com/rs/fireye/images/rpt-apt28.pdf"
                },
                {
                    "source_name": "s2grupo",
                    "description": "\"Evolution of Trickbot,\" S2 Grupo, report, Jun. 2017 [Online].",
                    "url": "https://www.securityartwork.es/wp-content/uploads/2017/07/Trickbot-report-S2-Grupo.pdf"
                },
                {
                    "source_name": "mcafee-webcobra",
                    "description": "\"WebCobra Malware Uses Victims' Computers to Mine Cryptocurrency,\" McAfee, blog, Nov. 12, 2018 [Online].",
                    "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/webcobra-malware-uses-victims-computers-to-mine-cryptocurrency/"
                },
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                },
                {
                    "source_name": "hromcov\u00e1",
                    "description": "Z. Hromcov\u00e1, \"Malicious campaign targets South Korean users with backdoor\u2011laced torrents,\" We Live Security, ESET, Jul. 8, 2019 [Online].",
                    "url": "https://www.welivesecurity.com/2019/07/08/south-korean-users-backdoor-torrents/"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}