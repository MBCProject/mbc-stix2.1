{
    "type": "bundle",
    "id": "bundle--c1a13192-d567-47c6-8710-7046b3239630",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--4a1da2ed-49c6-42b8-83e0-51eafdbdeea5",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2022-08-02T00:00:00.000Z",
            "modified": "2024-04-28T00:00:00.000Z",
            "name": "Modify Registry",
            "obj_defn": {
                "description": "Malware may make changes to the Windows Registry to hide execution or to persist on the system (note that ATT&CK does not extend this behavior to the Persistence objective). The Windows registry is a database that stores low-level settings for the operating system and for applications that opt to use the registry. Malware may create, delete, or modify registry keys and values to change the behavior of the system or certain applications. For instance, malware may modify registry keys to enable remote desktop connections, disable security features, or to automatically start the malware whenever the system boots. This technique is commonly used by various types of malware, including ransomware, trojans, and worms.\n\n\nSee ATT&CK: **Modify Registry ([T1112](https://attack.mitre.org/techniques/T1112/))**.",
                "external_id": "E1112",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/defense-evasion/modify-registry.md"
            },
            "objective_refs": [
                "malware-objective--debfe6b5-b30d-429f-aa74-b416af866f7b",
                "malware-objective--b0d7b24c-db02-461a-a9c9-bcf790572114"
            ],
            "detection_rules": [
                {
                    "rule_name": "persistence_remotedesktop",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/persistence_remotedesktop.py"
                },
                {
                    "rule_name": "browser_helper_object",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/browser_bho.py"
                },
                {
                    "rule_name": "browser_security",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/browser_security.py"
                },
                {
                    "rule_name": "disables_notificationcenter",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_notificationcenter.py"
                },
                {
                    "rule_name": "removes_networking_icon",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/removes_networking_icon.py"
                },
                {
                    "rule_name": "tampers_powershell_logging",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/tampers_powershell_logging.py"
                },
                {
                    "rule_name": "disables_power_options",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_power_options.py"
                },
                {
                    "rule_name": "disables_cpl_disable",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_cpl_display.py"
                },
                {
                    "rule_name": "browser_startpage",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/browser_startpage.py"
                },
                {
                    "api_fncs": [
                        "RegSetValueExA",
                        "RegSetValueExW",
                        "NtSetValueKey"
                    ],
                    "rule_type": "cape",
                    "rule_name": "persistence_registry_script",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/persistence_fileless.py"
                },
                {
                    "rule_name": "hides_recycle_bin_icon",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/hides_recyclebin_icon.py"
                },
                {
                    "rule_name": "disables_restore_default_state",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_restore_default_state.py"
                },
                {
                    "rule_name": "disables_auto_app_termination",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_app_autotermination.py"
                },
                {
                    "rule_name": "nemty_regkeys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/ransomware_nemty.py"
                },
                {
                    "rule_name": "warzonerat_regkeys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/rat_warzone.py"
                },
                {
                    "rule_name": "prevents_safeboot",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/prevents_safeboot.py"
                },
                {
                    "rule_name": "disables_smartscreen",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_smartscreen.py"
                },
                {
                    "rule_name": "disables_context_menus",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_context_menus.py"
                },
                {
                    "api_fncs": [
                        "RegCreateKeyExA",
                        "RegSetValueExA",
                        "RegCreateKeyExW",
                        "RegSetValueExW"
                    ],
                    "rule_type": "cape",
                    "rule_name": "reg_binary",
                    "url": "https://github.com/kevoreilly/CAPEv2/blob/master/modules/signatures/CAPE.py"
                },
                {
                    "rule_name": "stealth_hidden_extension",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/stealth_hiddenextension.py"
                },
                {
                    "rule_name": "disables_run_command",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_run_command.py"
                },
                {
                    "rule_name": "persistence_ifeo",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/persistence_ifeo.py"
                },
                {
                    "rule_name": "persistence_silent_process_exit",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/persistence_ifeo.py"
                },
                {
                    "rule_name": "disables_backups",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_backups.py"
                },
                {
                    "api_fncs": [
                        "RegSetValueExA",
                        "RegSetValueExW",
                        "NtSetValueKey"
                    ],
                    "rule_type": "cape",
                    "rule_name": "creates_largekey",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/creates_largekey.py"
                },
                {
                    "rule_name": "removes_username_startmenu",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/removes_username_startmenu.py"
                },
                {
                    "rule_name": "stealth_hiddenreg",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/stealth_hiddenreg.py"
                },
                {
                    "rule_name": "disables_startmenu_search",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_startmenu_search.py"
                },
                {
                    "rule_name": "stealth_hide_notifications",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/stealth_hidenotifications.py"
                },
                {
                    "rule_name": "disables_app_launch",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_app.py"
                },
                {
                    "api_fncs": [
                        "RegSetValueExA",
                        "RegSetValueExW"
                    ],
                    "rule_type": "cape",
                    "rule_name": "neshta_regkeys",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/neshta_regkeys.py"
                },
                {
                    "api_fncs": [
                        "NtCreateKey",
                        "NtSetValueKey"
                    ],
                    "rule_type": "cape",
                    "rule_name": "creates_nullvalue",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/creates_nullvalue.py"
                },
                {
                    "rule_name": "geodo_banking_trojan",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/banker_geodo.py"
                },
                {
                    "api_fncs": [
                        "NtSetValueKey",
                        "RegSetValueExA",
                        "RegSetValueExW",
                        "CreateServiceW",
                        "CreateServiceA"
                    ],
                    "rule_type": "cape",
                    "rule_name": "persistence_autorun",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/persistence_autorun.py"
                },
                {
                    "api_fncs": [
                        "NtSetValueKey",
                        "RegSetValueExA",
                        "RegSetValueExW",
                        "CreateServiceW",
                        "CreateServiceA"
                    ],
                    "rule_type": "cape",
                    "rule_name": "persistence_autorun_tasks",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/persistence_autorun.py"
                },
                {
                    "rule_name": "persistence_safeboot",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/persistence_autorun.py"
                },
                {
                    "rule_name": "modify_attachment_manager",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antiav_bypass.py"
                },
                {
                    "rule_name": "modify_certs",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/modifies_certs.py"
                },
                {
                    "rule_name": "modify_proxy",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/browser_proxy.py"
                },
                {
                    "rule_name": "disables_appv_virtualization",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_appv_virtualization.py"
                },
                {
                    "rule_name": "njrat_regkeys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/virus_neshta.py"
                },
                {
                    "rule_name": "modify_uac_prompt",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/modifies_uac_notify.py"
                },
                {
                    "api_fncs": [
                        "RegQueryValueExW",
                        "RegSetValueExW"
                    ],
                    "rule_type": "cape",
                    "rule_name": "blackrat_registry_keys",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/rat_blackremote.py"
                },
                {
                    "rule_name": "rdptcp_key",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/remote_desktop.py"
                },
                {
                    "rule_name": "disables_system_restore",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_sysrestore.py"
                },
                {
                    "rule_name": "disables_folder_options",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_folder_options.py"
                },
                {
                    "rule_name": "office_security",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/office_security.py"
                },
                {
                    "rule_name": "removes_security_maintenance_icon",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/removes_sec_maintain_icon.py"
                },
                {
                    "rule_name": "tampers_etw",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/tampers_etw.py"
                },
                {
                    "rule_name": "disables_event_logging",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_event_logging.py"
                },
                {
                    "rule_name": "browser_addon",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/browser_addon.py"
                },
                {
                    "rule_name": "removes_startmenu_defaults",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/removes_startmenu_defaults.py"
                },
                {
                    "rule_name": "disables_uac",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_uac.py"
                },
                {
                    "rule_name": "modify_security_center_warnings",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/modifies_seccenter.py"
                },
                {
                    "rule_name": "disables_wer",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_wer.py"
                },
                {
                    "rule_name": "office_perfkey",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/office_dll_loading.py"
                },
                {
                    "rule_name": "modify_oem_information",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/modifies_oem.py"
                },
                {
                    "rule_name": "limerat_regkeys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/rat_limerat.py"
                },
                {
                    "rule_name": "disables_windows_defender_dism",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_windefender.py"
                },
                {
                    "rule_name": "disables_windows_defender_logging",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_windefender.py"
                },
                {
                    "rule_name": "removes_windows_defender_contextmenu",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_windefender.py"
                },
                {
                    "rule_name": "disables_browser_warn",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_browserwarn.py"
                },
                {
                    "rule_name": "disables_windowsupdate",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_windowsupdate.py"
                },
                {
                    "rule_name": "removes_pinned_programs",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/removes_pinned_programs.py"
                },
                {
                    "rule_name": "medusalocker_regkeys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/ransomware_medusalocker.py"
                },
                {
                    "rule_name": "bypass_firewall",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/bypass_firewall.py"
                },
                {
                    "rule_name": "remcos_regkeys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/remcos.py"
                }
            ],
            "obj_version": "2.3",
            "related_object_refs": [
                "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"
            ],
            "external_references": [
                {
                    "source_name": "symantec",
                    "description": "Threat Hunter Team, \"Shuckworm: Espionage Group Continues Intense Campaign Against Ukraine,\" Symantec, Enterprise Blogs/Threat Intelligence, 20 Apr. 2022 [Online].",
                    "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/shuckworm-intense-campaign-ukraine"
                },
                {
                    "source_name": "hromcov\u00e1",
                    "description": "Z. Hromcov\u00e1, \"Malicious campaign targets South Korean users with backdoor\u2011laced torrents,\" We Live Security, ESET, Jul. 8, 2019 [Online].",
                    "url": "https://www.welivesecurity.com/2019/07/08/south-korean-users-backdoor-torrents/"
                },
                {
                    "source_name": "trendmicro-hupigon",
                    "description": "\"HUPIGON,\" Trend Micro, analysis report, Jul. 12, 2013 [Online].",
                    "url": "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/HUPIGON"
                },
                {
                    "source_name": "mendrez",
                    "description": "R. Mendrez, \"Gamut Spambot Analysis,\" Trustwave, blog, Mar. 4, 2014 [Online].",
                    "url": "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/gamut-spambot-analysis/"
                },
                {
                    "source_name": "taylor-kovter",
                    "description": "K. Taylor, \"Analysis of Kovter, a Very Clever Piece of Malware,\" VIPRE Labs, blog, Jun. 6, 2017 [Online].",
                    "url": "https://labs.vipre.com/analysis-of-kovter-a-very-clever-piece-of-malware/#:~:text=Kovter%20copies%20the%20fileless%20persistence,written%20on%20to%20the%20filesystem."
                },
                {
                    "source_name": "mundo-shamoon",
                    "description": "A. Mundo, \"Shamoon Returns to Wipe Systems in Middle East, Europe,\" McAfee, blog, Dec. 14, 2018 [Online].",
                    "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/shamoon-returns-to-wipe-systems-in-middle-east-europe/"
                },
                {
                    "source_name": "fireeye-apt28",
                    "description": "\"APT28: A Window into Russia's Cyber Espionage Operations?\" FireEye, 2014 [Online].",
                    "url": "https://www2.fireeye.com/rs/fireye/images/rpt-apt28.pdf"
                },
                {
                    "source_name": "symantec",
                    "description": "Threat Hunter Team, \"Shuckworm: Espionage Group Continues Intense Campaign Against Ukraine,\" Symantec, Enterprise Blogs/Threat Intelligence, 20 Apr. 2022 [Online].",
                    "url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/shuckworm-intense-campaign-ukraine"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}