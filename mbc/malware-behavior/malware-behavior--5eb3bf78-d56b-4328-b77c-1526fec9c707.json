{
    "type": "bundle",
    "id": "bundle--c0a6fd1e-a58f-4ff8-b0ce-4b1fd16d6eb5",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--5eb3bf78-d56b-4328-b77c-1526fec9c707",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2020-08-14T00:00:00.000Z",
            "modified": "2024-02-06T00:00:00.000Z",
            "name": "Keylogging",
            "obj_defn": {
                "description": "Malware captures user keyboard input.\n\nSee ATT&CK: **Input Capture: Keylogging ([T1056.001](https://attack.mitre.org/techniques/T1056/001), [T1417.001](https://attack.mitre.org/techniques/T1417/001/))**",
                "external_id": "F0002",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/collection/keylogging.md"
            },
            "objective_refs": [
                "malware-objective--cd26b9a0-1290-4c07-8fda-11aed09c75b4",
                "malware-objective--10c6e697-d5b1-45ef-8ee8-2f3d02c5a675"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "user32.GetAsyncKeyState",
                        "user32.GetKeyState",
                        "user32.GetKeyboardState",
                        "user32.VkKeyScan",
                        "user32.VkKeyScanEx",
                        "user32.GetKeyNameText"
                    ],
                    "detect_ref": "malware-method--b13a8621-6b9e-41cf-8b9a-6836973e1db0",
                    "rule_name": "log keystrokes via polling",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/collection/keylog/log-keystrokes-via-polling.yml"
                },
                {
                    "detect_ref": "malware-method--fe216739-7c47-45ec-a9f8-71234400b0ba",
                    "rule_name": "log keystrokes via application hook",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/collection/keylog/log-keystrokes-via-application-hook.yml"
                },
                {
                    "api_fncs": [
                        "SetWindowsHookExA",
                        "GetAsyncKeyState",
                        "SetWindowsHookExW"
                    ],
                    "detect_ref": "malware-behavior--5eb3bf78-d56b-4328-b77c-1526fec9c707",
                    "rule_name": "infostealer_keylog",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/infostealer_keylog.py"
                },
                {
                    "api_fncs": [
                        "SetWindowsHookExA",
                        "GetAsyncKeyState",
                        "SetWindowsHookExW"
                    ],
                    "detect_ref": "malware-method--fe216739-7c47-45ec-a9f8-71234400b0ba",
                    "rule_name": "infostealer_keylog",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/infostealer_keylog.py"
                },
                {
                    "api_fncs": [
                        "JsEval",
                        "COleScript_ParseScriptText",
                        "COleScript_Compile"
                    ],
                    "detect_ref": "malware-behavior--5eb3bf78-d56b-4328-b77c-1526fec9c707",
                    "rule_name": "browser_scanbox",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/browser_scanbox.py"
                }
            ],
            "obj_version": "2.2",
            "related_object_refs": [
                "attack-pattern--09a60ea3-a8d1-4ae5-976e-5783248b72a4",
                "attack-pattern--b1c95426-2550-4621-8028-ceebf28b3a47"
            ],
            "external_references": [
                {
                    "source_name": "fsecure-hupigon",
                    "description": "\"Backdoor:W32/Hupigon,\" F-Secure, Threat Description [Online].",
                    "url": "https://www.f-secure.com/v-descs/backdoor_w32_hupigon.shtml"
                },
                {
                    "source_name": "citizen lab",
                    "description": "M. Brooks, J. Dalek, and M. Crete-Nishihata, \"Between Hong Kong and Burma: Tracking UP007 and SLServer Espionage Campaigns,\" The Citizen Lab, Apr. 18, 2016 [Online].",
                    "url": "https://docs.microsoft.com/en-us/windows/win32/winmsg/about-hooks?redirectedfrom=MSDN#hook-procedures"
                },
                {
                    "source_name": "baumgartner-target",
                    "description": "K. Baumgartner and M. Garnaeva, \"BE2 custom plugins, router abuse, and target profiles: New observations on BlackEnergy2 APT activity,\" Secure List by Kaspersky, Nov. 3, 2014 [Online]. ",
                    "url": "https://securelist.com/be2-custom-plugins-router-abuse-and-target-profiles/67353/"
                },
                {
                    "source_name": "kujawa",
                    "description": "A. Kujawa, \"You dirty RAT! Part 1: DarkComet,\" Malwarebytes Labs, blog, Jun. 9, 2012 [Online].",
                    "url": "https://blog.malwarebytes.com/threat-analysis/2012/06/you-dirty-rat-part-1-darkcomet/"
                },
                {
                    "source_name": "njccic-poisonivy",
                    "description": "\"Poison Ivy,\" NJCCIC Threat Profile, Apr. 12, 2017 [Online].",
                    "url": "https://www.cyber.nj.gov/threat-center/threat-profiles/trojan-variants/poison-ivy"
                },
                {
                    "source_name": "fireeye-apt28",
                    "description": "\"APT28: A Window into Russia's Cyber Espionage Operations?\" FireEye, 2014 [Online].",
                    "url": "https://www2.fireeye.com/rs/fireye/images/rpt-apt28.pdf"
                },
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                },
                {
                    "source_name": "fireeye-poisonivy",
                    "description": "\"Poison Ivy: Assessing Damange and Extracting Intelligence,\" FireEye, Special Report, 2014 [Online].",
                    "url": "https://www.mandiant.com/sites/default/files/2021-09/rpt-poison-ivy.pdf"
                },
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}