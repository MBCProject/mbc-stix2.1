{
    "type": "bundle",
    "id": "bundle--d65777ee-2a51-4c6b-b0fe-6c8c6010e839",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--819ed2ae-7ed5-4caf-a057-485563efc26f",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2022-08-02T00:00:00.000Z",
            "modified": "2024-04-30T00:00:00.000Z",
            "name": "Command and Scripting Interpreter",
            "obj_defn": {
                "description": "Malware may abuse command and script interpreters to execute commands, scripts, or binaries. This is often done to carry out various malicious activities, such as exploring the system, escalating privileges, or exfiltrating data. Built-in command-line interpreters or scripting environments of the operating system, such as cmd.exe or Powershell on Windows, or Bash on Unix-like systems, are often used. Additionally, adversaries may use other scripting languages like Python, Perl, or Javascript. \n\nSee ATT&CK: **Command and Scripting Interpreter ([T1059](https://attack.mitre.org/techniques/T1059), [T1623](https://attack.mitre.org/techniques/T1623))**.",
                "external_id": "E1059",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/execution/command-and-scripting-interpreter.md"
            },
            "objective_refs": [
                "malware-objective--3336569b-d163-4a42-9b05-9eff0c7ac6d2"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "GetCommandLine",
                        "CommandLineToArgv",
                        "System.Environment::GetCommandLineArgs"
                    ],
                    "rule_name": "accept command line arguments",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/cli/accept-command-line-arguments.yml"
                },
                {
                    "api_fncs": [
                        "System.Management.Automation.PowerShell::Create",
                        "System.Management.Automation.PowerShell::AddScript",
                        "System.Management.Automation.PowerShell::Invoke"
                    ],
                    "rule_name": "run PowerShell expression",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/load-code/powershell/run-powershell-expression.yml"
                },
                {
                    "api_fncs": [
                        "NtWriteFile"
                    ],
                    "rule_name": "office_postscript",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/office_exploit.py"
                },
                {
                    "api_fncs": [
                        "CDocument_write",
                        "JsEval",
                        "COleScript_ParseScriptText",
                        "COleScript_Compile"
                    ],
                    "rule_name": "js_suspicious_redirect",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/js_suspicious_redirect.py"
                },
                {
                    "rule_name": "odbcconf_bypass",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/bypass_applocker.py"
                },
                {
                    "api_fncs": [
                        "LdrLoadDll"
                    ],
                    "rule_name": "regsvr32_squiblydoo_dll_load",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/bypass_applocker.py"
                },
                {
                    "rule_name": "squiblydoo_bypass",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/bypass_applocker.py"
                },
                {
                    "rule_name": "squiblytwo_bypass",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/bypass_applocker.py"
                },
                {
                    "api_fncs": [
                        "JsEval"
                    ],
                    "rule_name": "exe_dropper_js",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/dropper_js.py"
                },
                {
                    "api_fncs": [
                        "RegSetValueExA",
                        "RegSetValueExW",
                        "NtSetValueKey"
                    ],
                    "rule_name": "persistence_registry_script",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/persistence_fileless.py"
                },
                {
                    "rule_name": "ie_martian_children",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/martians_ie.py"
                },
                {
                    "api_fncs": [
                        "ShellExecuteExW",
                        "NtCreateUserProcess",
                        "CreateProcessInternalW"
                    ],
                    "rule_name": "bcdedit_command",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/bcdedit_command.py"
                },
                {
                    "rule_name": "office_martian_children",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/martians_office.py"
                },
                {
                    "api_fncs": [
                        "JsEval",
                        "COleScript_ParseScriptText",
                        "COleScript_Compile"
                    ],
                    "rule_name": "js_phish",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/js_phish.py"
                },
                {
                    "rule_name": "disables_winfirewall",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_winfirewall.py"
                },
                {
                    "rule_name": "script_tool_executed",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/windows_utilities.py"
                },
                {
                    "rule_name": "cmdline_obfuscation",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "rule_name": "cmdline_switches",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "rule_name": "cmdline_terminate",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "rule_name": "cmdline_forfiles_wildcard",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "rule_name": "cmdline_http_link",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "rule_name": "cmdline_long_string",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "rule_name": "cmdline_reversed_http_link",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "rule_name": "long_commandline",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "rule_name": "powershell_renamed_commandline",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/cmdline_anomaly.py"
                },
                {
                    "api_fncs": [
                        "NtCreateUserProcess",
                        "CreateProcessInternalW"
                    ],
                    "rule_name": "wmi_script_process",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/wmi.py"
                },
                {
                    "api_fncs": [
                        "ShellExecuteExW",
                        "NtCreateUserProcess",
                        "CreateProcessInternalW"
                    ],
                    "rule_name": "disables_mappeddrives_autodisconnect",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_drives_autodisconnect.py"
                },
                {
                    "rule_name": "system_account_discovery_cmd",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_name": "system_currently_loggedin_user_cmd",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_name": "system_info_discovery_cmd",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_name": "system_info_discovery_pwsh",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_name": "system_network_discovery_cmd",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_name": "system_network_discovery_pwsh",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "rule_name": "system_user_discovery_cmd",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/collects_systeminfo_cmd.py"
                },
                {
                    "api_fncs": [
                        "URLDownloadToFileW",
                        "HttpOpenRequestW",
                        "send",
                        "WSAConnect",
                        "InternetCrackUrlW",
                        "InternetCrackUrlA",
                        "InternetReadFile"
                    ],
                    "rule_name": "powershell_network_connection",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/powershell_command.py"
                },
                {
                    "rule_name": "powershell_scriptblock_logging",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/powershell_command.py"
                },
                {
                    "rule_name": "powershell_command_suspicious",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/powershell_command.py"
                },
                {
                    "rule_name": "powershell_renamed",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/powershell_command.py"
                },
                {
                    "rule_name": "powershell_reversed",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/powershell_command.py"
                },
                {
                    "rule_name": "powershell_variable_obfuscation",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/powershell_command.py"
                },
                {
                    "api_fncs": [
                        "LdrGetDllHandle",
                        "LdrLoadDll"
                    ],
                    "rule_name": "office_com_load",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/office_dll_loading.py"
                },
                {
                    "api_fncs": [
                        "LdrGetDllHandle",
                        "LdrLoadDll"
                    ],
                    "rule_name": "office_vb_load",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/office_dll_loading.py"
                },
                {
                    "api_fncs": [
                        "LdrGetDllHandle",
                        "LdrLoadDll"
                    ],
                    "rule_name": "office_wmi_load",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/office_dll_loading.py"
                },
                {
                    "api_fncs": [
                        "NtWriteFile"
                    ],
                    "rule_name": "document_script_exe_drop",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/document_exedrop.py"
                },
                {
                    "rule_name": "windows_defender_powershell",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/disables_windefender.py"
                },
                {
                    "api_fncs": [
                        "NtCreateUserProcess",
                        "CreateProcessInternalW"
                    ],
                    "rule_name": "office_suspicious_processes",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/office_suspicious_process.py"
                },
                {
                    "api_fncs": [
                        "NtCreateUserProcess",
                        "CreateProcessInternalW"
                    ],
                    "rule_name": "script_created_process",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/script_downloader.py"
                },
                {
                    "api_fncs": [
                        "URLDownloadToFileW",
                        "HttpOpenRequestW",
                        "send",
                        "WSAConnect",
                        "InternetCrackUrlW",
                        "InternetCrackUrlA",
                        "SslEncryptPacket",
                        "InternetReadFile"
                    ],
                    "rule_name": "script_network_activity",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/script_downloader.py"
                },
                {
                    "api_fncs": [
                        "JsEval",
                        "COleScript_ParseScriptText"
                    ],
                    "rule_name": "suspicious_js_script",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/script_downloader.py"
                }
            ],
            "obj_version": "2.2",
            "related_object_refs": [
                "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830",
                "attack-pattern--29f1f56c-7b7a-4c14-9e39-59577ea2743c"
            ],
            "external_references": [
                {
                    "source_name": "njccic-poisonivy",
                    "description": "\"Poison Ivy,\" NJCCIC Threat Profile, Apr. 12, 2017 [Online].",
                    "url": "https://www.cyber.nj.gov/threat-center/threat-profiles/trojan-variants/poison-ivy"
                },
                {
                    "source_name": "hromcov\u00e1",
                    "description": "Z. Hromcov\u00e1, \"Malicious campaign targets South Korean users with backdoor\u2011laced torrents,\" We Live Security, ESET, Jul. 8, 2019 [Online].",
                    "url": "https://www.welivesecurity.com/2019/07/08/south-korean-users-backdoor-torrents/"
                },
                {
                    "source_name": "bleeping-kovter",
                    "description": "\"How to remove the Kovter Trojan (Removal Guide),\" Bleeping Computer, Mar. 23, 2016 [Online].",
                    "url": "https://www.bleepingcomputer.com/virus-removal/remove-kovter-trojan"
                },
                {
                    "source_name": "palotay",
                    "description": "D. Palotay and P. Mackenzie, \"SamSam Ransomware Chooses Its Targets Carefully,\" Sophos Labs, Apr. 2018 [Online].",
                    "url": "https://www.sophos.com/en-us/medialibrary/PDFs/technical-papers/SamSam-ransomware-chooses-Its-targets-carefully-wpna.pdf"
                },
                {
                    "source_name": "mundo-shamoon",
                    "description": "A. Mundo, \"Shamoon Returns to Wipe Systems in Middle East, Europe,\" McAfee, blog, Dec. 14, 2018 [Online].",
                    "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/shamoon-returns-to-wipe-systems-in-middle-east-europe/"
                },
                {
                    "source_name": "falliere-stuxnet",
                    "description": "N. Falliere, L. Murchu, and E. Chien, \"W32.Stuxnet Dossier,\" Symantec Security Response, Feb. 2011 [Online].",
                    "url": "https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en"
                },
                {
                    "source_name": "marschalek",
                    "description": "M. Marschalek, \"EvilBunny: Malware Instrumented by Lua,\" Cyphort Labs, blog, Dec. 16, 2014 [Online].",
                    "url": "https://web.archive.org/web/20150311013500/http://www.cyphort.com/evilbunny-malware-instrumented-lua/"
                },
                {
                    "source_name": "victor-netwalker",
                    "description": "K. Victor, \"Reflective Loading Runs Netwalker Fileless Ransomware,\" Trend Micro, May 18, 2020 [Online].",
                    "url": "https://www.trendmicro.com/en_us/research/20/e/netwalker-fileless-ransomware-injected-via-reflective-loading.html"
                },
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                },
                {
                    "source_name": "reed-mac",
                    "description": "T. Reed, \"Mac malware intercepts encrypted web traffic for ad injection,\" Malwarebytes Labs, blog, Oct. 24, 2018 [Online].",
                    "url": "https://www.malwarebytes.com/blog/news/2018/10/mac-malware-intercepts-encrypted-web-traffic-for-ad-injection"
                },
                {
                    "source_name": "mcafee-webcobra",
                    "description": "\"WebCobra Malware Uses Victims' Computers to Mine Cryptocurrency,\" McAfee, blog, Nov. 12, 2018 [Online].",
                    "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/webcobra-malware-uses-victims-computers-to-mine-cryptocurrency/"
                },
                {
                    "source_name": "malwarebytes-kovter",
                    "description": "\"Untangling Kovter's persistence methods,\" Malwarebytes Labs, blog, Jul. 14, 2016 [Online].",
                    "url": "https://blog.malwarebytes.com/threat-analysis/2016/07/untangling-kovter/"
                },
                {
                    "source_name": "njccic-poisonivy",
                    "description": "\"Poison Ivy,\" NJCCIC Threat Profile, Apr. 12, 2017 [Online].",
                    "url": "https://www.cyber.nj.gov/threat-center/threat-profiles/trojan-variants/poison-ivy"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}