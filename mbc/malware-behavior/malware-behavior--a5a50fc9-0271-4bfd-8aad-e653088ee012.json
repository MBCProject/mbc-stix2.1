{
    "type": "bundle",
    "id": "bundle--831936ef-13f9-4ed9-b64b-b9f245e6db12",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2020-08-14T00:00:00.000Z",
            "modified": "2023-12-05T00:00:00.000Z",
            "name": "HTTP Communication",
            "obj_defn": {
                "description": "This micro-behavior is related to HTTP communication. \n\nInstead of being listed alphabetically, methods have been grouped to better faciliate labeling and mapping.",
                "external_id": "C0002",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/micro-behaviors/communication/http-communication.md"
            },
            "objective_refs": [
                "malware-objective--eed3a014-5c09-4ba1-b574-53c4f8294470"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "winhttp.WinHttpQueryHeaders"
                    ],
                    "detect_ref": "malware-method--1d272666-843a-4db4-8dca-c336f0ef2fc4",
                    "rule_name": "read HTTP header",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/read-http-header.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpOpen"
                    ],
                    "detect_ref": "malware-method--e8755ee9-2652-4ed5-8750-64e2eb5255d3",
                    "rule_name": "initialize WinHTTP library",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/initialize-winhttp-library.yml"
                },
                {
                    "api_fncs": [
                        "ole32.CoCreateInstance"
                    ],
                    "detect_ref": "malware-method--f000d5d8-0c5f-4b99-b281-e41f661150a8",
                    "rule_name": "initialize IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/initialize-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "wininet.HttpQueryInfo"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "get HTTP content length",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/get-http-content-length.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpAddRequestHeaders",
                        "System.Net.WebHeaderCollection::Add"
                    ],
                    "detect_ref": "malware-method--f4a3dd94-7ffc-46e2-aaf8-45fec5604d45",
                    "rule_name": "set HTTP header",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/set-http-header.yml"
                },
                {
                    "api_fncs": [
                        "urlmon.ObtainUserAgentString"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "reference HTTP User-Agent string",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/reference-http-user-agent-string.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpInitialize",
                        "httpapi.HttpTerminate",
                        "System.Net.HttpListener::Start"
                    ],
                    "detect_ref": "malware-method--085ee0df-016d-4a56-8f91-8d85ad503d0c",
                    "rule_name": "start HTTP server",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/start-http-server.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpReceiveHttpRequest",
                        "httpapi.HttpReceiveRequestEntityBody"
                    ],
                    "detect_ref": "malware-method--31cc0091-137f-4448-9ed6-5f88650ba890",
                    "rule_name": "receive HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/receive-http-request.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpSendHttpResponse",
                        "httpapi.HttpSendResponseEntityBody"
                    ],
                    "detect_ref": "malware-method--13858567-ca78-4a99-9b2f-acbed4763d2e",
                    "rule_name": "send HTTP response",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/send-http-response.yml"
                },
                {
                    "api_fncs": [
                        "System.Net.WebRequest::GetResponse",
                        "winhttp.WinHttpReceiveResponse",
                        "winhttp.WinHttpReadData",
                        "winhttp.WinHttpQueryDataAvailable"
                    ],
                    "detect_ref": "malware-method--297f08d3-e974-4ada-9cb4-360161f11ba3",
                    "rule_name": "receive HTTP response",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/receive-http-response.yml"
                },
                {
                    "api_fncs": [
                        "System.Net.WebRequest::GetResponse",
                        "System.Net.WebRequest::GetResponseAsync",
                        "wininet.HttpOpenRequest",
                        "wininet.InternetConnect",
                        "wininet.HttpSendRequest",
                        "wininet.HttpSendRequestEx",
                        "winhttp.WinHttpSendRequest",
                        "winhttp.WinHttpWriteData",
                        "winhttp.WinHttpOpenRequest",
                        "winhttp.WinHttpConnect"
                    ],
                    "detect_ref": "malware-method--ca0534c5-f1c2-44a2-820a-8e4714445f9f",
                    "rule_name": "send HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/send-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetReadFile",
                        "wininet.InternetReadFileEx",
                        "System.Net.WebClient::DownloadString",
                        "System.Net.WebClient::DownloadStringAsync",
                        "System.Net.WebClient::DownloadStringTaskAsync",
                        "System.Net.WebClient::DownloadData",
                        "System.Net.WebClient::DownloadDataAsync",
                        "System.Net.WebClient::DownloadDataTaskAsync"
                    ],
                    "detect_ref": "malware-method--297f08d3-e974-4ada-9cb4-360161f11ba3",
                    "rule_name": "read data from Internet",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/read-data-from-internet.yml"
                },
                {
                    "api_fncs": [
                        "oleaut32.SysAllocString",
                        "oleaut32.VariantInit"
                    ],
                    "detect_ref": "malware-method--297f08d3-e974-4ada-9cb4-360161f11ba3",
                    "rule_name": "get HTTP document via IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-document-via-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "oleaut32.SysAllocString",
                        "oleaut32.VariantInit"
                    ],
                    "detect_ref": "malware-method--f000d5d8-0c5f-4b99-b281-e41f661150a8",
                    "rule_name": "get HTTP document via IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-document-via-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "urlmon.URLDownloadToFile",
                        "urlmon.URLDownloadToCacheFile",
                        "urlmon.URLOpenBlockingStream",
                        "urlmon.URLOpenPullStream",
                        "urlmon.URLOpenStream",
                        "System.Net.WebClient::DownloadFile",
                        "System.Net.WebClient::DownloadFileAsync",
                        "System.Net.WebClient::DownloadFileTaskAsync",
                        "Microsoft.VisualBasic.Devices.Network::DownloadFile"
                    ],
                    "detect_ref": "malware-method--f5ea87a7-98d4-4399-a7b7-c1135c2401e9",
                    "rule_name": "download URL",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/download-url.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpOpenRequest"
                    ],
                    "detect_ref": "malware-method--b9b21211-c48a-4d87-8588-c15e9817a4cd",
                    "rule_name": "prepare HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/prepare-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetOpen",
                        "System.Net.WebRequest::Create",
                        "System.Net.WebRequest::CreateDefault",
                        "System.Net.WebRequest::CreateHttp",
                        "wininet.InternetCloseHandle"
                    ],
                    "detect_ref": "malware-method--b9b21211-c48a-4d87-8588-c15e9817a4cd",
                    "rule_name": "create HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/create-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetWriteFile"
                    ],
                    "detect_ref": "malware-method--51c5a3ff-1786-4ba0-872a-5c37077557ef",
                    "rule_name": "send file via HTTP",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/send-file-via-http.yml"
                },
                {
                    "rule_name": "decompress HTTP response via IEncodingFilterFactory",
                    "detect_ref": "malware-method--297f08d3-e974-4ada-9cb4-360161f11ba3",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/decompress-http-response-via-iencodingfilterfactory.yml"
                },
                {
                    "api_fncs": [
                        "atoi",
                        "wininet.HttpQueryInfo"
                    ],
                    "detect_ref": "malware-method--1d272666-843a-4db4-8dca-c336f0ef2fc4",
                    "rule_name": "check HTTP status code",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/check-http-status-code.yml"
                },
                {
                    "api_fncs": [
                        "wininet.HttpQueryInfo"
                    ],
                    "detect_ref": "malware-method--297f08d3-e974-4ada-9cb4-360161f11ba3",
                    "rule_name": "get HTTP response content encoding",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-response-content-encoding.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetOpenUrl"
                    ],
                    "detect_ref": "malware-method--48318fc3-7856-4b45-965d-a5742555ec7b",
                    "rule_name": "connect to URL",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/connect-to-url.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetConnect"
                    ],
                    "detect_ref": "malware-method--c3d3c94c-2667-416e-95a5-c10498f23d3a",
                    "rule_name": "connect to HTTP server",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/connect-to-http-server.yml"
                },
                {
                    "detect_ref": "malware-method--d0e7472c-0ea1-4ba6-ab50-9288280730b4",
                    "rule_name": "extract HTTP body",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/extract-http-body.yml"
                },
                {
                    "api_fncs": [
                        "HttpOpenRequestA",
                        "InternetConnectA",
                        "HttpOpenRequestW",
                        "InternetConnectW"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "internet_dropper",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/internet_dropper.py"
                },
                {
                    "rule_name": "bot_madness",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_madness.py"
                },
                {
                    "rule_name": "bot_madness",
                    "detect_ref": "malware-method--ca0534c5-f1c2-44a2-820a-8e4714445f9f",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_madness.py"
                },
                {
                    "rule_name": "bot_drive",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_drive.py"
                },
                {
                    "rule_name": "bot_drive",
                    "detect_ref": "malware-method--51c5a3ff-1786-4ba0-872a-5c37077557ef",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_drive.py"
                },
                {
                    "rule_name": "network_cnc_http",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/network_cnc_http.py"
                },
                {
                    "api_fncs": [
                        "HttpOpenRequestA",
                        "HttpSendRequestA"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "recon_beacon",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/recon_beacon.py"
                },
                {
                    "rule_name": "network_http",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/network_http.py"
                },
                {
                    "api_fncs": [
                        "WinHttpConnect",
                        "WinHttpOpenRequest"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "explorer_http",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/explorer_http.py"
                },
                {
                    "rule_name": "bot_drive2",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_drive2.py"
                },
                {
                    "rule_name": "bot_drive2",
                    "detect_ref": "malware-method--51c5a3ff-1786-4ba0-872a-5c37077557ef",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_drive2.py"
                },
                {
                    "rule_name": "bot_dirtjumper",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_dirtjumper.py"
                },
                {
                    "rule_name": "bot_dirtjumper",
                    "detect_ref": "malware-method--51c5a3ff-1786-4ba0-872a-5c37077557ef",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_dirtjumper.py"
                },
                {
                    "rule_name": "bot_athenahttp",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/bot_athenahttp.py"
                },
                {
                    "api_fncs": [
                        "HttpOpenRequestW",
                        "WinHttpOpenRequest"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "koadic_network_activity",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/koadic_network_activity.py"
                },
                {
                    "api_fncs": [
                        "HttpOpenRequestA",
                        "HttpOpenRequestW",
                        "InternetConnectW",
                        "InternetOpenUrlA",
                        "InternetConnectA",
                        "InternetOpenUrlW",
                        "WinHttpGetProxyForUrl"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "http_request",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/http_request.py"
                },
                {
                    "rule_name": "cmdline_http_link",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/cmdline_http_link.py"
                },
                {
                    "rule_name": "cmdline_reversed_http_link",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/cmdline_reversed_http_link.py"
                },
                {
                    "api_fncs": [
                        "InternetOpenUrlW",
                        "InternetOpenUrlA"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "https_urls",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/https_urls.py"
                },
                {
                    "api_fncs": [
                        "URLDownloadToFileW",
                        "HttpOpenRequestW",
                        "InternetCrackUrlW",
                        "InternetCrackUrlA",
                        "WSASend",
                        "InternetReadFile"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "network_document_http",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/network_document_http.py"
                },
                {
                    "rule_name": "banker_zeus_url",
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/banker_zeus_url.py"
                },
                {
                    "api_fncs": [
                        "WinHttpOpenRequest",
                        "InternetOpenUrlA"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "downloads_from_filehosting",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/downloads_from_filehosting.py"
                },
                {
                    "api_fncs": [
                        "InternetOpenW",
                        "HttpOpenRequestW",
                        "HttpSendRequestW",
                        "HttpAddRequestHeadersA"
                    ],
                    "detect_ref": "malware-behavior--a5a50fc9-0271-4bfd-8aad-e653088ee012",
                    "rule_name": "purplewave_network_activity",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/purplewave_network_activity.py"
                }
            ],
            "obj_version": "2.1",
            "external_references": [
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}