{
    "type": "bundle",
    "id": "bundle--2e1f2404-1fd2-4914-ba75-1b9e1244dadc",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--c889b142-22b2-4e82-9412-cf5528523f56",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2020-08-14T00:00:00.000Z",
            "modified": "2024-04-30T00:00:00.000Z",
            "name": "HTTP Communication",
            "obj_defn": {
                "description": "This micro-behavior is related to HTTP communication. \n\nInstead of being listed alphabetically, methods have been grouped to better faciliate labeling and mapping.",
                "external_id": "C0002",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/micro-behaviors/communication/http-communication.md"
            },
            "objective_refs": [
                "malware-objective--5823a1fb-61cd-4484-abfc-adfa88cca816"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "winhttp.WinHttpQueryHeaders"
                    ],
                    "detect_ref": "malware-method--f497cb57-7379-4ee2-a82d-72f6af86428a",
                    "rule_name": "read HTTP header",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/read-http-header.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpOpen"
                    ],
                    "detect_ref": "malware-method--d7c2b07a-e9e6-462f-a3c0-fd7db1bb2e4c",
                    "rule_name": "initialize WinHTTP library",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/initialize-winhttp-library.yml"
                },
                {
                    "api_fncs": [
                        "ole32.CoCreateInstance"
                    ],
                    "detect_ref": "malware-method--bf8e63c7-87a3-4653-a12e-5435d862ca09",
                    "rule_name": "initialize IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/initialize-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "wininet.HttpQueryInfo"
                    ],
                    "rule_name": "get HTTP content length",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/get-http-content-length.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpAddRequestHeaders",
                        "System.Net.WebHeaderCollection::Add"
                    ],
                    "detect_ref": "malware-method--b64291e4-c45a-4453-b913-65dba7268a1a",
                    "rule_name": "set HTTP header",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/set-http-header.yml"
                },
                {
                    "api_fncs": [
                        "urlmon.ObtainUserAgentString"
                    ],
                    "rule_name": "reference HTTP User-Agent string",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/reference-http-user-agent-string.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpInitialize",
                        "httpapi.HttpTerminate",
                        "System.Net.HttpListener::Start"
                    ],
                    "detect_ref": "malware-method--1a300b38-c1ee-499b-9407-d5dbb6b34f8c",
                    "rule_name": "start HTTP server",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/start-http-server.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpReceiveHttpRequest",
                        "httpapi.HttpReceiveRequestEntityBody"
                    ],
                    "detect_ref": "malware-method--350f8e7d-a2c1-435f-a0bd-03160cc222ff",
                    "rule_name": "receive HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/receive-http-request.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpSendHttpResponse",
                        "httpapi.HttpSendResponseEntityBody"
                    ],
                    "detect_ref": "malware-method--d64110a6-b465-472d-b0c7-fa3202c60a9d",
                    "rule_name": "send HTTP response",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/send-http-response.yml"
                },
                {
                    "api_fncs": [
                        "System.Net.WebRequest::GetResponse",
                        "winhttp.WinHttpReceiveResponse",
                        "winhttp.WinHttpReadData",
                        "winhttp.WinHttpQueryDataAvailable"
                    ],
                    "detect_ref": "malware-method--f99e6728-13ac-4d81-9566-6d800737c68b",
                    "rule_name": "receive HTTP response",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/receive-http-response.yml"
                },
                {
                    "api_fncs": [
                        "System.Net.WebRequest::GetResponse",
                        "System.Net.WebRequest::GetResponseAsync",
                        "wininet.HttpOpenRequest",
                        "wininet.InternetConnect",
                        "wininet.HttpSendRequest",
                        "wininet.HttpSendRequestEx",
                        "winhttp.WinHttpSendRequest",
                        "winhttp.WinHttpWriteData",
                        "winhttp.WinHttpOpenRequest",
                        "winhttp.WinHttpConnect"
                    ],
                    "detect_ref": "malware-method--c291cee5-5ea7-468a-8974-dc2624e7cbae",
                    "rule_name": "send HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/send-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetReadFile",
                        "wininet.InternetReadFileEx",
                        "System.Net.WebClient::DownloadString",
                        "System.Net.WebClient::DownloadStringAsync",
                        "System.Net.WebClient::DownloadStringTaskAsync",
                        "System.Net.WebClient::DownloadData",
                        "System.Net.WebClient::DownloadDataAsync",
                        "System.Net.WebClient::DownloadDataTaskAsync"
                    ],
                    "detect_ref": "malware-method--f99e6728-13ac-4d81-9566-6d800737c68b",
                    "rule_name": "read data from Internet",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/read-data-from-internet.yml"
                },
                {
                    "api_fncs": [
                        "oleaut32.SysAllocString",
                        "oleaut32.VariantInit"
                    ],
                    "detect_ref": "malware-method--f99e6728-13ac-4d81-9566-6d800737c68b",
                    "rule_name": "get HTTP document via IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-document-via-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "oleaut32.SysAllocString",
                        "oleaut32.VariantInit"
                    ],
                    "detect_ref": "malware-method--bf8e63c7-87a3-4653-a12e-5435d862ca09",
                    "rule_name": "get HTTP document via IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-document-via-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "urlmon.URLDownloadToFile",
                        "urlmon.URLDownloadToCacheFile",
                        "urlmon.URLOpenBlockingStream",
                        "urlmon.URLOpenPullStream",
                        "urlmon.URLOpenStream",
                        "System.Net.WebClient::DownloadFile",
                        "System.Net.WebClient::DownloadFileAsync",
                        "System.Net.WebClient::DownloadFileTaskAsync",
                        "Microsoft.VisualBasic.Devices.Network::DownloadFile"
                    ],
                    "detect_ref": "malware-method--addcbbea-4e82-4816-a138-0b19ddacd043",
                    "rule_name": "download URL",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/download-url.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpOpenRequest"
                    ],
                    "detect_ref": "malware-method--d80c5d48-e802-4732-b48a-c71b84f4703a",
                    "rule_name": "prepare HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/prepare-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetOpen",
                        "System.Net.WebRequest::Create",
                        "System.Net.WebRequest::CreateDefault",
                        "System.Net.WebRequest::CreateHttp",
                        "wininet.InternetCloseHandle"
                    ],
                    "detect_ref": "malware-method--d80c5d48-e802-4732-b48a-c71b84f4703a",
                    "rule_name": "create HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/create-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetWriteFile"
                    ],
                    "detect_ref": "malware-method--9d13adf5-2774-4ea2-bbb1-ba8e8e3ca7ea",
                    "rule_name": "send file via HTTP",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/send-file-via-http.yml"
                },
                {
                    "rule_name": "decompress HTTP response via IEncodingFilterFactory",
                    "detect_ref": "malware-method--f99e6728-13ac-4d81-9566-6d800737c68b",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/decompress-http-response-via-iencodingfilterfactory.yml"
                },
                {
                    "api_fncs": [
                        "atoi",
                        "wininet.HttpQueryInfo"
                    ],
                    "detect_ref": "malware-method--f497cb57-7379-4ee2-a82d-72f6af86428a",
                    "rule_name": "check HTTP status code",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/check-http-status-code.yml"
                },
                {
                    "api_fncs": [
                        "wininet.HttpQueryInfo"
                    ],
                    "detect_ref": "malware-method--f99e6728-13ac-4d81-9566-6d800737c68b",
                    "rule_name": "get HTTP response content encoding",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-response-content-encoding.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetOpenUrl"
                    ],
                    "detect_ref": "malware-method--7d0ddef2-0802-48db-8a42-73b356ed083a",
                    "rule_name": "connect to URL",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/connect-to-url.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetConnect"
                    ],
                    "detect_ref": "malware-method--57c1f0f9-f551-4be2-857e-a9f168999eb1",
                    "rule_name": "connect to HTTP server",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/connect-to-http-server.yml"
                },
                {
                    "detect_ref": "malware-method--7f1b234a-9409-4a3a-9f4c-03e21d04770a",
                    "rule_name": "extract HTTP body",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/extract-http-body.yml"
                },
                {
                    "api_fncs": [
                        "HttpOpenRequestA",
                        "InternetConnectA",
                        "HttpOpenRequestW",
                        "InternetConnectW"
                    ],
                    "class": "Internet_Dropper",
                    "rule_name": "internet_dropper",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/internet_dropper.py"
                },
                {
                    "rule_name": "bot_madness",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_madness.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "bot_madness",
                    "detect_ref": "malware-method--c291cee5-5ea7-468a-8974-dc2624e7cbae",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_madness.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "bot_drive",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_drive.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "bot_drive",
                    "detect_ref": "malware-method--9d13adf5-2774-4ea2-bbb1-ba8e8e3ca7ea",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_drive.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "network_cnc_http",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/network_cnc_http.py",
                    "rule_type": "cape"
                },
                {
                    "api_fncs": [
                        "HttpOpenRequestA",
                        "HttpSendRequestA"
                    ],
                    "rule_name": "recon_beacon",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/recon_beacon.py"
                },
                {
                    "rule_name": "network_http",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/network_http.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "bot_drive2",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_drive2.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "bot_drive2",
                    "detect_ref": "malware-method--9d13adf5-2774-4ea2-bbb1-ba8e8e3ca7ea",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_drive2.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "bot_dirtjumper",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_dirtjumper.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "bot_dirtjumper",
                    "detect_ref": "malware-method--9d13adf5-2774-4ea2-bbb1-ba8e8e3ca7ea",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_dirtjumper.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "bot_athenahttp",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/bot_athenahttp.py",
                    "rule_type": "cape"
                },
                {
                    "api_fncs": [
                        "HttpOpenRequestA",
                        "HttpOpenRequestW",
                        "InternetConnectW",
                        "InternetOpenUrlA",
                        "InternetConnectA",
                        "InternetOpenUrlW",
                        "WinHttpGetProxyForUrl"
                    ],
                    "rule_name": "http_request",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/http_request.py"
                },
                {
                    "rule_name": "banker_zeus_url",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/all/banker_zeus_url.py",
                    "rule_type": "cape"
                },
                {
                    "api_fncs": [
                        "HttpSendRequestA,HttpOpenRequestA"
                    ],
                    "rule_name": "reacon_beacon",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/recon_beacon.py"
                },
                {
                    "api_fncs": [
                        "InternetCrackUrlW",
                        "InternetCrackUrlA",
                        "URLDownloadToFileW",
                        "HttpOpenRequestW",
                        "InternetReadFile",
                        "WSASend"
                    ],
                    "rule_name": "network_docfile_http",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/network_docfile_http.py"
                },
                {
                    "api_fncs": [
                        "InternetOpenW",
                        "HttpAddRequestHeadersA",
                        "HttpSendRequestW",
                        "HttpOpenRequestW"
                    ],
                    "rule_name": "infostealer_purplewave",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/infostealer_purplewave.py"
                },
                {
                    "api_fncs": [
                        "InternetOpenUrlA",
                        "WinHttpOpenRequest"
                    ],
                    "rule_name": "filehostings",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/filehostings.py"
                },
                {
                    "api_fncs": [
                        "WinHttpConnect",
                        "WinHttpOpenRequest"
                    ],
                    "rule_name": "network_explorer",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/network_explorer.py"
                },
                {
                    "rule_name": "cmdline_anomaly.py",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/cmdline_anomaly.py",
                    "rule_type": "cape"
                },
                {
                    "rule_name": "cmdline_anomaly.py",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/cmdline_anomaly.py",
                    "rule_type": "cape"
                },
                {
                    "api_fncs": [
                        "WinHttpOpenRequest",
                        "HttpOpenRequestW"
                    ],
                    "rule_name": "exploitation_framework_koadic.py",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/exploitation_framework_koadic.py"
                },
                {
                    "api_fncs": [
                        "WinHttpOpen"
                    ],
                    "rule_name": "ransomware_sodinokibi",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/ransomware_sodinokibi.py"
                },
                {
                    "api_fncs": [
                        "HttpOpenRequestW"
                    ],
                    "rule_name": "powershell_command",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/blob/master/modules/signatures/windows/powershell_command.py"
                }
            ],
            "obj_version": "2.2",
            "external_references": [
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}