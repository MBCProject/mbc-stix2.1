{
    "type": "bundle",
    "id": "bundle--768c057b-9cb8-485b-ab68-03c871b70a51",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2019-08-01T00:00:00.000Z",
            "modified": "2024-02-06T00:00:00.000Z",
            "name": "Virtual Machine Detection",
            "obj_defn": {
                "description": "Malware checks whether it is being executed inside a virtual environment. In performing reconnaissance of its environment, the malware will check on a variety of user or system based artifacts. Examples include: \n\n- monitoring for user action as reflected by scrolling\n- verifying system characteristics through Windows Management Interface (WMI) queries, e.g., for MAC address\n- observing whether tool artifacts represented by strings or processes exist, e.g., VirtualBox.exe or joeboxserver.exe  \n- checking specific registry keys or values [1]\n\nUpon detection of the virtual machine, conditional execution will change the malware\u2019s behavior. For example, execution may terminate, or activity may appear benign, e.g., connecting to a benign domain.\n\nThe related **Virtualization/Sandbox Evasion ([T1497](https://attack.mitre.org/techniques/T1497/), [T1633](https://attack.mitre.org/techniques/T1633/))** ATT&CK techniques were defined subsequent to this MBC behavior.",
                "external_id": "B0009",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/anti-behavioral-analysis/virtual-machine-detection.md"
            },
            "tags": {
                "Anti-Analysis-Type": "Detection"
            },
            "objective_refs": [
                "malware-objective--475598d1-fbe7-4924-816b-d7cf358a6acb"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "GetModuleHandle"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "check for sandbox and av modules",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-av/check-for-sandbox-and-av-modules.yml"
                },
                {
                    "api_fncs": [
                        "SLIsGenuineLocal",
                        "UuidFromString"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "check for Windows sandbox via genuine state",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/check-for-windows-sandbox-via-genuine-state.yml"
                },
                {
                    "rule_name": "reference anti-VM strings targeting Parallels",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/reference-anti-vm-strings-targeting-parallels.yml"
                },
                {
                    "detect_ref": "malware-method--076edfe4-ec0f-463a-a2a0-1054c434fc77",
                    "rule_name": "check for unmoving mouse cursor",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/check-for-unmoving-mouse-cursor.yml"
                },
                {
                    "rule_name": "reference anti-VM strings targeting VirtualPC",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/reference-anti-vm-strings-targeting-virtualpc.yml"
                },
                {
                    "rule_name": "reference anti-VM strings targeting VMWare",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/reference-anti-vm-strings-targeting-vmware.yml"
                },
                {
                    "api_fncs": [
                        "Sleep"
                    ],
                    "detect_ref": "malware-method--076edfe4-ec0f-463a-a2a0-1054c434fc77",
                    "rule_name": "check for foreground window switch",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/check-for-foreground-window-switch.yml"
                },
                {
                    "detect_ref": "malware-method--7f46d82a-fab6-4e8f-9d49-3afd658323e8",
                    "rule_name": "detect VM via disk hardware WMI queries",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/detect-vm-via-disk-hardware-wmi-queries.yml"
                },
                {
                    "rule_name": "reference anti-VM strings targeting Qemu",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/reference-anti-vm-strings-targeting-qemu.yml"
                },
                {
                    "rule_name": "reference anti-VM strings targeting Xen",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/reference-anti-vm-strings-targeting-xen.yml"
                },
                {
                    "rule_name": "check for sandbox username or hostname",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/check-for-sandbox-username-or-hostname.yml"
                },
                {
                    "rule_name": "check for Windows sandbox via process name",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/check-for-windows-sandbox-via-process-name.yml"
                },
                {
                    "api_fncs": [
                        "GetAdaptersAddresses"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "check for Windows sandbox via dns suffix",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/check-for-windows-sandbox-via-dns-suffix.yml"
                },
                {
                    "rule_name": "check for Windows sandbox via device",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/check-for-windows-sandbox-via-device.yml"
                },
                {
                    "rule_name": "reference anti-VM strings targeting VirtualBox",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/reference-anti-vm-strings-targeting-virtualbox.yml"
                },
                {
                    "api_fncs": [
                        "RegOpenKeyEx",
                        "RegEnumValue"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "check for Windows sandbox via registry",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/check-for-windows-sandbox-via-registry.yml"
                },
                {
                    "rule_name": "reference anti-VM strings",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-vm/vm-detection/reference-anti-vm-strings.yml"
                },
                {
                    "api_fncs": [
                        "DeviceIoControl",
                        "NtClose",
                        "NtCreateFile",
                        "NtDuplicateObject",
                        "NtOpenFile",
                        "NtDeviceIoControlFile"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_generic_disk",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_disk.py"
                },
                {
                    "api_fncs": [
                        "DeviceIoControl",
                        "NtClose",
                        "NtCreateFile",
                        "NtDuplicateObject",
                        "NtOpenFile",
                        "NtDeviceIoControlFile"
                    ],
                    "detect_ref": "malware-method--a461f6e9-20e1-42eb-911e-b2c305927b39",
                    "rule_name": "antivm_generic_disk",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_disk.py"
                },
                {
                    "rule_name": "antivm_vpc_mutex",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vpc_mutex.py"
                },
                {
                    "api_fncs": [
                        "NtQueryDirectoryObject",
                        "NtOpenDirectoryObject"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_directory_objects",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_directory_objects.py"
                },
                {
                    "api_fncs": [
                        "NtQueryDirectoryObject",
                        "NtOpenDirectoryObject"
                    ],
                    "detect_ref": "malware-method--833bb666-f739-496f-9e96-9e6ec01d21c8",
                    "rule_name": "antivm_directory_objects",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_directory_objects.py"
                },
                {
                    "api_fncs": [
                        "GetAdaptersAddresses"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_network_adapters",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_network_adapters.py"
                },
                {
                    "rule_name": "antivm_generic_cpu",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_cpu.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_generic_cpu",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_cpu.py"
                },
                {
                    "detect_ref": "malware-method--ea2b6c95-eae6-4235-a57f-666ecccc1c44",
                    "rule_name": "antivm_generic_cpu",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_cpu.py"
                },
                {
                    "api_fncs": [
                        "WNetGetProviderNameW"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_vbox_provname",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_provname.py"
                },
                {
                    "api_fncs": [
                        "WNetGetProviderNameW"
                    ],
                    "detect_ref": "malware-method--833bb666-f739-496f-9e96-9e6ec01d21c8",
                    "rule_name": "antivm_vbox_provname",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_provname.py"
                },
                {
                    "rule_name": "antivm_generic_bios",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_bios.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_generic_bios",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_bios.py"
                },
                {
                    "detect_ref": "malware-method--ea2b6c95-eae6-4235-a57f-666ecccc1c44",
                    "rule_name": "antivm_generic_bios",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_bios.py"
                },
                {
                    "rule_name": "antivm_vbox_keys",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_keys.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_vbox_keys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_keys.py"
                },
                {
                    "api_fncs": [
                        "NtOpenEvent",
                        "NtCreateEvent"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_vmware_events",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_events.py"
                },
                {
                    "rule_name": "antivm_vbox_devices",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_devices.py"
                },
                {
                    "detect_ref": "malware-method--fa9b9a87-51cc-42bd-b374-97239fefd995",
                    "rule_name": "antivm_vbox_devices",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_devices.py"
                },
                {
                    "rule_name": "antivm_vmware_devices",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_devices.py"
                },
                {
                    "detect_ref": "malware-method--fa9b9a87-51cc-42bd-b374-97239fefd995",
                    "rule_name": "antivm_vmware_devices",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_devices.py"
                },
                {
                    "rule_name": "antivm_hyperv_keys",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_hyperv_keys.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_hyperv_keys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_hyperv_keys.py"
                },
                {
                    "rule_name": "antivm_vbox_files",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_files.py"
                },
                {
                    "detect_ref": "malware-method--fa9b9a87-51cc-42bd-b374-97239fefd995",
                    "rule_name": "antivm_vbox_files",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_files.py"
                },
                {
                    "api_fncs": [
                        "SetWindowsHookExA",
                        "SetWindowsHookExW"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antisandbox_mouse_hook",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antisandbox_mouse_hook.py"
                },
                {
                    "api_fncs": [
                        "SetWindowsHookExA",
                        "SetWindowsHookExW"
                    ],
                    "detect_ref": "malware-method--076edfe4-ec0f-463a-a2a0-1054c434fc77",
                    "rule_name": "antisandbox_mouse_hook",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antisandbox_mouse_hook.py"
                },
                {
                    "api_fncs": [
                        "RegOpenKeyExW",
                        "RegQueryValueExA",
                        "RegQueryValueExW",
                        "RegOpenKeyExA"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_generic_scsi",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_scsi.py"
                },
                {
                    "api_fncs": [
                        "RegOpenKeyExW",
                        "RegQueryValueExA",
                        "RegQueryValueExW",
                        "RegOpenKeyExA"
                    ],
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_generic_scsi",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_scsi.py"
                },
                {
                    "api_fncs": [
                        "LdrLoadDll"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_vmware_libs",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_libs.py"
                },
                {
                    "api_fncs": [
                        "LdrLoadDll"
                    ],
                    "detect_ref": "malware-method--833bb666-f739-496f-9e96-9e6ec01d21c8",
                    "rule_name": "antivm_vmware_libs",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_libs.py"
                },
                {
                    "rule_name": "antivm_xen_keys",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_xen_keys.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_xen_keys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_xen_keys.py"
                },
                {
                    "rule_name": "antivm_parallels_keys",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_parallels_keys.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_parallels_keys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_parallels_keys.py"
                },
                {
                    "rule_name": "antivm_generic_diskreg",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_diskreg.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_generic_diskreg",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_diskreg.py"
                },
                {
                    "rule_name": "antivm_vpc_keys",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vpc_keys.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_vpc_keys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vpc_keys.py"
                },
                {
                    "rule_name": "antivm_bochs_keys",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_bochs_keys.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_bochs_keys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_bochs_keys.py"
                },
                {
                    "rule_name": "antivm_vpc_files",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vpc_files.py"
                },
                {
                    "rule_name": "antivm_vpc_files",
                    "detect_ref": "malware-method--833bb666-f739-496f-9e96-9e6ec01d21c8",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vpc_files.py"
                },
                {
                    "rule_name": "antivm_vmware_mutexes",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_mutexes.py"
                },
                {
                    "api_fncs": [
                        "LdrLoadDll"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_vbox_libs",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_libs.py"
                },
                {
                    "api_fncs": [
                        "LdrLoadDll"
                    ],
                    "detect_ref": "malware-method--833bb666-f739-496f-9e96-9e6ec01d21c8",
                    "rule_name": "antivm_vbox_libs",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_libs.py"
                },
                {
                    "rule_name": "antivm_generic_system",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_system.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_generic_system",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_system.py"
                },
                {
                    "rule_name": "antivm_vmware_files",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_files.py"
                },
                {
                    "rule_name": "antivm_vmware_files",
                    "detect_ref": "malware-method--833bb666-f739-496f-9e96-9e6ec01d21c8",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_files.py"
                },
                {
                    "api_fncs": [
                        "RegOpenKeyExW",
                        "RegEnumKeyExW",
                        "RegEnumKeyExA",
                        "RegOpenKeyExA"
                    ],
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_generic_services",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_services.py"
                },
                {
                    "api_fncs": [
                        "RegOpenKeyExW",
                        "RegEnumKeyExW",
                        "RegEnumKeyExA",
                        "RegOpenKeyExA"
                    ],
                    "detect_ref": "malware-method--9af67637-f5d1-4a3c-9057-affd0ab6924a",
                    "rule_name": "antivm_generic_services",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_services.py"
                },
                {
                    "api_fncs": [
                        "SetupDiGetClassDevsA",
                        "SetupDiGetClassDevsW"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antivm_generic_disk_setupapi",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_generic_disk_setupapi.py"
                },
                {
                    "api_fncs": [
                        "NtOpenDirectoryObject"
                    ],
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_name": "antisandbox_sboxie_objects",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antisandbox_sboxie_objects.py"
                },
                {
                    "rule_name": "antivm_vmware_keys",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_keys.py"
                },
                {
                    "detect_ref": "malware-method--6bcd0840-f72a-46e2-b36a-d43a7aecd249",
                    "rule_name": "antivm_vmware_keys",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vmware_keys.py"
                },
                {
                    "rule_name": "antivm_vbox_window",
                    "detect_ref": "malware-behavior--e656b809-4c81-4bf2-b7e8-46b5f6f4daa1",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_window.py"
                },
                {
                    "detect_ref": "malware-method--84c28c9f-8d5d-4aa7-9d82-50fa294ceed4",
                    "rule_name": "antivm_vbox_window",
                    "rule_type": "cape",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/antivm_vbox_window.py"
                }
            ],
            "snippets": [
                {
                    "exemplify_ref": "malware-method--ce2ff02c-03c6-4325-8d79-f35d127dc60f",
                    "hash": "SHA256: cfaf863181e49906df33f9104795678f2fb41a007a8fd066a84fd99f613d7ef3",
                    "language": "asm",
                    "snippet": "; ___unwind { // __except handler4\npush ebp\nmov ebp, esp\npush 0FFFFFFFEh\npush offset stru_413980\npush offset __except handler4\nmov eax, large fs:0\npush eax\nsub esp, 14h\npush ebx\npush esi\npush edi\nmov eax, ___security_cookie\nxor [epb+ms_exc.registration.ScopeTable], eax\nxor eax, ebp\npush eax\nlea eax, [ebp+ms_exc.registration]\nmov large fs:0 eax\nmov [ebp+var_19], al\n;  __try { // __except at loc_401CB8\nmov [ebp+ms_exc.registration.TryLevel], eax\npush ebx\nmov ebx, 0\nmov eax, 1\nvpcext 7, 08h\ntest ebx, ebx\nsetz [ebp+var_19]\npop ebx\njmp short loc_401CBB"
                }
            ],
            "obj_version": "2.2",
            "related_object_refs": [
                "attack-pattern--82caa33e-d11a-433a-94ea-9b5a5fbef81d",
                "attack-pattern--27d18e87-8f32-4be1-b456-39b90454360f"
            ],
            "external_references": [
                {
                    "source_name": "checkpoint",
                    "description": "Check Point Research, \"CP<r>: Evasion Techniques,\" evasions.checkpoint.com, [Online].",
                    "url": "https://evasions.checkpoint.com"
                },
                {
                    "source_name": "unprotect-sandboxevasion",
                    "description": "T. Roccia and J. Lesueur, \"Sandbox Evasion,\" Unprotect Project, Accessed Apr. 29, 2023 [Online].",
                    "url": "https://unprotect.it/category/sandbox-evasion/"
                },
                {
                    "source_name": "rascagneres-gravityrat",
                    "description": "P. Rascagneres, \"GravityRAT - The Two-Year Evolution Of An APT Targeting India,\" Talos, blog, Apr. 26, 2018 [Online].",
                    "url": "https://blog.talosintelligence.com/2018/04/gravityrat-two-year-evolution-of-apt.html"
                },
                {
                    "source_name": "mcafee-webcobra",
                    "description": "\"WebCobra Malware Uses Victims' Computers to Mine Cryptocurrency,\" McAfee, blog, Nov. 12, 2018 [Online].",
                    "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/webcobra-malware-uses-victims-computers-to-mine-cryptocurrency/"
                },
                {
                    "source_name": "lordnoteworthy",
                    "description": "A. Faouzi (LordNoteworthy), \"README.md,\" Al-Khaser v0.81. Accessed Apr. 29, 2023 [Online].",
                    "url": "https://github.com/LordNoteworthy/al-khaser"
                },
                {
                    "source_name": "fireeye-vmaware",
                    "description": "\"The Dead Giveaways of VM-Aware Malware,\" FireEye, Jan 2011.",
                    "url": "https://web.archive.org/web/20160927120026/https://web.archive.org/web/20200815134441/https://www.fireeye.com/blog/threat-research/2011/01/the-dead-giveaways-of-vm-aware-malware.html"
                },
                {
                    "source_name": "shulmin-emotet",
                    "description": "A. Shulmin, \"The Banking Trojan Emotet: Detailed Analysis,\" Secure List by Kaspersky, Apr. 9, 2015 [Online].",
                    "url": "https://securelist.com/the-banking-trojan-emotet-detailed-analysis/69560/"
                },
                {
                    "source_name": "sonicwall",
                    "description": "\"Revisiting Vobfus Worm,\" SonicWALL, Mar. 8, 2013 [Online].",
                    "url": "https://securitynews.sonicwall.com/xmlpost/revisiting-vobfus-worm-mar-8-2013/"
                },
                {
                    "source_name": "dong-matanbuchus",
                    "description": "C. Dong, \"MATANBUCHUS: Another Loader as a Service Malware,\" Offset Training Solutions, blog, Feb. 15, 2022 [Online].",
                    "url": "https://www.0ffset.net/reverse-engineering/matanbuchus-loader-analysis/"
                },
                {
                    "source_name": "cohen-matabuchus",
                    "description": "B. Cohen, \"Inside Matanbuchus: A Quirky Loader,\" CyberArk, blog, Jul. 26, 2022 [Online].",
                    "url": "https://www.cyberark.com/resources/threat-research-blog/inside-matanbuchus-a-quirky-loader"
                },
                {
                    "source_name": "proofpoint-ursnif",
                    "description": "\"Ursnif Banking Trojan Campaign Ups the Ante with New Sandbox Evasion Techniques,\" Proofpoint, Sep. 20, 2016 [Online].",
                    "url": "https://www.proofpoint.com/us/threat-insight/post/ursnif-banking-trojan-campaign-sandbox-evasion-techniques"
                },
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                },
                {
                    "source_name": "hackread",
                    "description": "Waqas, \"GravityRAT malware evades detection and targets users in India,\" HACKREAD, May 1, 2018.",
                    "url": "https://www.hackread.com/gravityrat-malware-evades-detection-targets-india/"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}