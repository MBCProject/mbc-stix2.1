{
    "type": "bundle",
    "id": "bundle--a9108696-15ce-406e-8c17-e9e14b1232fd",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--eef921fd-4091-480f-a78a-5aec6ae34c9c",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2019-08-01T00:00:00.000Z",
            "modified": "2024-04-27T00:00:00.000Z",
            "name": "Debugger Evasion",
            "obj_defn": {
                "source_name": "mitre-mbc",
                "description": "Debugger evasion is employed by malware to foil a debugger and avoid analysis. For example, to hinder the malware analyst and debugger, malware may use exception handling to execute non-obvious execution paths (exception misdirection method) or may use several parallel threads (parallel threads method). Additional debugger evasion methods are described below.\n\nA thorough reference for anti-debugging, both detection and evasion, is given in [1].\n\nThe related **Debugger Evasion ([T1622](https://attack.mitre.org/techniques/T1622/))** ATT&CK technique was defined subsequent to this MBC behavior.",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/anti-behavioral-analysis/debugger-evasion.md",
                "external_id": "B0002"
            },
            "tags": {
                "Anti-Analysis-Type": "Evasion"
            },
            "objective_refs": [
                "malware-objective--e263c1d4-d543-4869-9549-f95769105f1c"
            ],
            "detection_rules": [
                {
                    "rule_type": "capa",
                    "rule_name": "hide thread from debugger",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-debugging/debugger-evasion/hide-thread-from-debugger.yml",
                    "api_fncs": [
                        "NtSetInformationThread",
                        "ZwSetInformationThread",
                        "GetCurrentThread"
                    ]
                },
                {
                    "rule_type": "capa",
                    "rule_name": "switch active desktop",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/gui/switch-active-desktop.yml",
                    "api_fncs": [
                        "user32.CreateDesktop",
                        "user32.SwitchDesktop"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antidebug_guardpages",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antidebug_guardpages.py",
                    "api_fncs": [
                        "VirtualProtectEx",
                        "NtAllocateVirtualMemory",
                        "NtProtectVirtualMemory"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antidebug_guardpages",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antidebug_guardpages.py",
                    "api_fncs": [
                        "VirtualProtectEx",
                        "NtAllocateVirtualMemory",
                        "NtProtectVirtualMemory"
                    ],
                    "detect_ref": "malware-method--119f0ce0-c3b9-44c8-9d6e-4710ebbbfcf5"
                },
                {
                    "rule_type": "cape",
                    "rule_name": "antidebug_ntcreatethreadex",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/antidebug_ntcreatethreadex.py",
                    "api_fncs": [
                        "NtCreateThreadEx"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "debugs_self",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/debugs_self.py",
                    "api_fncs": [
                        "CreateProcessInternalW"
                    ]
                },
                {
                    "rule_type": "cape",
                    "rule_name": "debugs_self",
                    "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/debugs_self.py",
                    "api_fncs": [
                        "CreateProcessInternalW"
                    ],
                    "detect_ref": "malware-method--8f26003e-cc64-4c62-a964-57e87c5b20fa"
                }
            ],
            "obj_version": "2.3",
            "related_object_refs": [
                "attack-pattern--e4dc8c01-417f-458d-9ee0-bb0617c1b391"
            ],
            "external_references": [
                {
                    "source_name": "ferrie",
                    "description": "P. Ferrie, \"The Ultimate Anti-Debugging Reference,\" May 4, 2011 [Online].",
                    "url": "https://anti-reversing.com/Downloads/Anti-Reversing/The_Ultimate_Anti-Reversing_Reference.pdf"
                },
                {
                    "source_name": "synack",
                    "description": "\"Analyzing the Anti-Analysis Logic of an Adware Installer,\" Synack, Feb. 2, 2016.",
                    "url": "https://objective-see.org/blog/blog_0x0C.html"
                },
                {
                    "source_name": "fireeye-vmaware",
                    "description": "\"The Dead Giveaways of VM-Aware Malware,\" FireEye, Jan 2011.",
                    "url": "https://web.archive.org/web/20160927120026/https://web.archive.org/web/20200815134441/https://www.fireeye.com/blog/threat-research/2011/01/the-dead-giveaways-of-vm-aware-malware.html"
                },
                {
                    "source_name": "sonicwall",
                    "description": "\"Revisiting Vobfus Worm,\" SonicWALL, Mar. 8, 2013 [Online].",
                    "url": "https://securitynews.sonicwall.com/xmlpost/revisiting-vobfus-worm-mar-8-2013/"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}